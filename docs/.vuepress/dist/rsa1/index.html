<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RSAv1 | w33k_ctf</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.d28fe075.js" as="script"><link rel="preload" href="/assets/js/2.0bd0f446.js" as="script"><link rel="preload" href="/assets/js/1.631e745b.js" as="script"><link rel="preload" href="/assets/js/34.f3afb0d4.js" as="script"><link rel="prefetch" href="/assets/js/10.8e2c5d19.js"><link rel="prefetch" href="/assets/js/11.3c6d9b95.js"><link rel="prefetch" href="/assets/js/12.56fca55f.js"><link rel="prefetch" href="/assets/js/13.b441d08d.js"><link rel="prefetch" href="/assets/js/14.10c6843e.js"><link rel="prefetch" href="/assets/js/15.845454d7.js"><link rel="prefetch" href="/assets/js/16.8f5891b3.js"><link rel="prefetch" href="/assets/js/17.fef59687.js"><link rel="prefetch" href="/assets/js/18.5cf32ab8.js"><link rel="prefetch" href="/assets/js/19.34204f89.js"><link rel="prefetch" href="/assets/js/20.24f07836.js"><link rel="prefetch" href="/assets/js/21.7f8f7869.js"><link rel="prefetch" href="/assets/js/22.3f20ce36.js"><link rel="prefetch" href="/assets/js/23.a4908e7f.js"><link rel="prefetch" href="/assets/js/24.e8893bb7.js"><link rel="prefetch" href="/assets/js/25.9b942a89.js"><link rel="prefetch" href="/assets/js/26.8a5dd96f.js"><link rel="prefetch" href="/assets/js/27.a0b25126.js"><link rel="prefetch" href="/assets/js/28.7e0c2718.js"><link rel="prefetch" href="/assets/js/29.b4bb0668.js"><link rel="prefetch" href="/assets/js/3.64ae4e2d.js"><link rel="prefetch" href="/assets/js/30.f89e4b38.js"><link rel="prefetch" href="/assets/js/31.c3059120.js"><link rel="prefetch" href="/assets/js/32.fbc67663.js"><link rel="prefetch" href="/assets/js/33.8e09942d.js"><link rel="prefetch" href="/assets/js/35.c7c3e0a8.js"><link rel="prefetch" href="/assets/js/4.8fda9edc.js"><link rel="prefetch" href="/assets/js/5.d8fe19d3.js"><link rel="prefetch" href="/assets/js/6.d445a503.js"><link rel="prefetch" href="/assets/js/7.18e362ed.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4ad8f938.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">w33k_ctf</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rsav1"><a href="#rsav1" class="header-anchor">#</a> RSAv1</h1> <hr> <ol><li>Замечаем что сообщение шифрует 3 ключа с маленькой открытой экспонентой. Это даёт нам возможность провести атаку <a href="https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7_RSA" target="_blank" rel="noopener noreferrer">Хастада<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Проводим атаку и получаем флаг. Пример кода на Python</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sympy
<span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
<span class="token keyword">from</span> rsa<span class="token punctuation">.</span>common <span class="token keyword">import</span> crt

n <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">89093261285937741803553185783021286637837446366257063142111405753387662825269100645612486076518482796619865870376379536466857902923577748653278104722708190446522260968530611966850359527455148502617105893232509721719097053093330869480335969105582166109173804985696779322959351467421786895137401704612961447471</span><span class="token punctuation">,</span>
    <span class="token number">97464014826405325330166412621280304163610060117159184182690802007658552317082555618665227947729740511605474842144870213327806874641620937381764619420443599474633254425937284871386116420164952139603473613599265451046929404344988017311336827575844000385510412617202904050146245842046531515370476448217586971577</span><span class="token punctuation">,</span>
    <span class="token number">77829907924872079986563262733250475640840107267128175883438043029932259643507571827348224129825953566855278699384533886350108484449812228046683692878067627938931867643806003443595142258837457888127250902580415422555192638711648295143759129223592364675864498876982948027520255263439801788633432497910619525011</span><span class="token punctuation">]</span>
c <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">89019265952859376440007932990401155238216892818194426647588940408006208153673414651166781872064111919640916922765481502090474881698278030628365117577329488598397693848714092849993050696270421728811779656348980736058160976430889731291067710216377831603435373292744927370809955903336940175941846584942549040913</span><span class="token punctuation">,</span>
    <span class="token number">16686570729809544999024344229357209928856207505660860590634916412291583249643903176489987351331087143323867841368563111202092617782760627876978791856106613122389776761226463626114119582727202565583400059809979233084206428639308568597733116807608979716420336716707290851054900988072680608598866873993629826545</span><span class="token punctuation">,</span>
    <span class="token number">26976954223169618973946656826388558174571578217048626680309299198021439320982536423303964553825567211723525957969643881549953199917592552831896999596016961849917946640157585439412214926122267815002803325369069835772081521510390021799309197858234759937606267650296983898301762425200689069979082112194675880186</span><span class="token punctuation">]</span>

e <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> b <span class="token operator">=</span> sympy<span class="token punctuation">.</span>integer_nthroot<span class="token punctuation">(</span>i<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token keyword">if</span> b<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> crt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
a <span class="token operator">=</span> sympy<span class="token punctuation">.</span>integer_nthroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Флаг</strong> <code>w33k{878f0003d9f8a2d64c387691f487eca3c1fc25b9693eb31cc40b0fd38c6763ca}</code></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d28fe075.js" defer></script><script src="/assets/js/2.0bd0f446.js" defer></script><script src="/assets/js/1.631e745b.js" defer></script><script src="/assets/js/34.f3afb0d4.js" defer></script>
  </body>
</html>
